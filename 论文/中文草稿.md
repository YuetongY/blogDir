# BBCP: A Blockchain based Open Source Contribution Protection System

## 1. Introduction

基于开源贡献保护的区块链系统

## 2. The architecture of the proposed BBCP platform

为了更好的保护开源世界中大众协同开发的知识成果，维护大众的利益，我们提出了BBCP平台。如图1，它由三个部分组成：Client、Trustie 以及 Fabric Network

Client 就是一个基于 Nodejs 编写的工具，供开发人员在日常开发任务中使用。该工具允许开发人员同 Fabric Network 以及 Trustie 进行交互。此外，它集成了所有的 git 命令，可以像使用 git 一样方便的对本地 Repo 进行操作。

Trustie 是一个供大众协同开发的群智平台。与 github 类似，它支持代码托管、代码clone、版本库上线等几乎所有的功能。通过集成 gitlab，使它可以安全、高效的对 git 仓库进行控制。到目前为止，该平台托管的项目已有数十万。大量的开发人员在该平台上进行协同办公。

Fabric Network 是整个平台的核心，基于 hyperledger fabric 搭建。它负责提供安全和可信的存储网络，所有 commit 交易记录都会保存在链上，以此来确保数据的安全可靠信。此外，平台会将对应的 commit 代码转换为一定数量的 token，然后累加到提交该次 commit 的 user 账号中。

## 3. Key mechanisms of the BBCP platform

### 3.1 Chain Tool

Chain Tool 是用于操作本地 Repo 的客户端工具。它有两个版本，master 版本主要由开发人员使用，兼容针对 git 版本库操作的所有命令。此外，它还支持 token 查询，用户创建等基础性功能。trustie 版本则只部署在 Trustie 服务端。现阶段主要提供 pull request 功能支持。当 Trustie 服务端收到 PR 请求时，会调用该方法，将用户对开源版本库所作的贡献转换为一定数量的 token 存入 fabric network 的 world state 中。同时会将 commit hash 等关键数据记录在区块中。

该工具使用的框架是 nodejs。它适合用于编写轻量级的应用工具，并且易于界面化。可以认为是数据密集型分布式部署环境下的实时应用系统的完美解决方案。其提供非阻塞模式的IO处理带来在相对低系统资源能耗下的高性能和出众的负载能力。此外，fabric network 中 API 服务端也是使用的 nodejs，配合起来更便利。

图二是 chain push 的机制图。首先调用 Chain push 命令将最新的 commit 信息上传至 Trustie，成功后调用 Curl push 命令将本次 push 操作的核心内容传入 Fabric Network 中。Fabric Network 调用 chaincode 向 Trustie 发起 Http request，Trustie 判断传入的 push 内容是否真实存在，而不是人为作假，并且返回该次 push 内容所得 token 值。chaincode 根据返回的信息，更新该用户在 world state 中的状态。

![push process.png](https://ws1.sinaimg.cn/large/006alGmrly1g6vdguttuxj30jj0e1aax.jpg)

图三则是 Pull Request 机制图。先是开发人员将 Fork Repo 中最新的 commit 记录提交至 Trustie 服务器。之后，开发人员可以在自己的页面查看到最新的提交信息，并发起 Pull Request 请求。目的是将本次对 Fork Repo 的修改同步到原 Repo 中。原 Repo 核心开发人员看到 Pull Request 请求后，评估该请求的价值，合格则合并该请求到当前原 Repo。同时，Trustie server 调用 Curl trustiePush 命令，将该次合并所作的贡献值 Token和关键数据传入 Fabric Network 中。chaincode 更新对应用户的世界状态，并记录操作上链。

![pull request process.png](https://ws1.sinaimg.cn/large/006alGmrly1g6vdvafvo5j30r90aeab5.jpg)

### 3.2 Trustie Platform

Trustie 是构建面向群体化实践教学的支撑平台。它基于群体化实践教学的思想，围绕阅读和维护高质量的开源软件，以及开发有创意、上规模的软件系统两个方面。Trustie 平台涵盖了对开源代码阅读与评价、开源资源的分析与共享、实践项目的协同开发等群体化实践教学的支持，主要包括数据存储管理、核心支撑机制、关键子系统以及 Web 交互等

本文主要关注的是实践项目协同开发部分。其支持开源项目实践任务开展分布式协作实践，提供任务跟踪、协同开发等群体协同工具，以及代码质量、个体能力等持续评估工具。trustie 开发社区中的项目创建者覆盖了来自全国 150 多所高校的近 1000 名师生以及约 25个科研院所和创新实验室的科研人员，包括北斗开源实验室、国内首个机器人操作系统团队Micros、国际顶尖机器人竞技团队 Nubot 以及国家超级计算广州中心等。此外，还有超过 200 多名自由软件爱好者也在平台中通过项目贡献了自己的代码、开发经验以及心得文档等。

trustie 主要提供对代码仓库进行托管的服务。如图四所示，它可以提供项目目标规划、里程碑设置来控制项目工作的进展，保证目标规划的实现；提供项目任务（需求、功能、支持、缺陷等）分配管理机制，使开发过程能够有序进行；提供项目进度统计、分析、通知等，确保协作团队之间所修改的代码保持一致性和完整性；提供wiki、论坛等以实现群体知识分享与高效协同。此外，Trustie 需要验证来自 chaincode 数据的真实性，防止别人随意调用 API，破坏网络的建设。Trusite 还可以将开发人员对开源项目的贡献定量的转换为 Token，并记录在区块链上，永久保存。Token 占有比例可以在一定程度上说明开发人员对项目的总贡献程度。一旦有企业愿意收购该项目，Token 就可以兑换金钱，开发人员就可以获得相应的收益。目前，Token 计算的方式为：每添加或者删除一行代码均加1。

![image.png](https://ws1.sinaimg.cn/large/006alGmrly1g6vm0u4826j30j60edq4s.jpg)

### 3.3 Blockchcian Network



## 4. Related Work

### Hyperledger fabric

比特币是一种点对点的电子加密货币系统，于2009年被一个号称是中本聪的人或组织提出。区块链则是它的主要核心技术。区块链可以被认为是一个公共账本，它由一个个区块通过 hash 值连接起来，每个区块中存储若干交易账本。其核心技术包括：加密 hash、数字签名和分布式共识机制等。具有安全性、透明性、自治性和高匿名性等优点。
hyperledger fabric是安全的企业级联盟链平台，支持节点管理和验证。每一个用户都可以通过证书彼此相连。可以非常安全的管理数据。主要源码贡献IBM。fabric 是一个分布式账本平台的实现，该平台利用熟悉和成熟的技术运行智能合约，采用模块化架构，允许各种功能的可插拔实现。fabric 分布式账本协议运行在 peers 节点上。peers 节点角色分两种，一种是 validating peer，用于出块达成共识。另一种是 non-validating peer，用于为交易背书，存储区块等。

### Blockchain in Intellectual Property Protection

近年来，知识产权保护问题越来越受到大众关注，因为仿冒产品和商标每年将会造成数千亿美元的损失。Zuleika Beaven, et al. 思考音乐产业和区块链技术的结合，利用区块链技术对音乐作品进行知识产权保护Soundchain 平台就是其中的一个代表，在 Russia 被广泛用于承担音乐产业领域的产权保护活动

在工业 4.0 时代，3D 打印技术是一项革命性的创新。有人认为该制造流程是一个商品。但是整个产业链都被版权问题所困扰。Martin HOLLAND, et al. 结合区块链技术将整个过程链商业化实施的同时，有效的防止知识产权盗窃。一旦有途中有任何风险，都可以被识别，并提供相应的解决方案。目前该方案正在由一个名为 SAMPL 的项目开发

相对于音乐和3D打印产业，艺术品图像版权问题并不受大众所重视。但其在网络上的肆意传播会给创作者和整个产业链带来严重的危害。 Ma Zhaofeng, et al. 提出了一种基于水印和区块链的艺术品图像数字版权管理方案，具有高鲁棒性和安全性。一旦网络上可疑的图像数据被滥用，未经授权在网络上传播，就可以通过该系统来追踪盗用人的责任。

CKshare 是一个基于私有云和区块链技术的可信赖的模具再设计知识共享平台。它使用私有云存储模具的原始数据，利用区块链网络对模具数据和交易进行记录，以保证数据的安全性和可靠性。该平台可扩展到其它类似的应用场景。

利用区块链技术进行知识产权保护的领域有很多，包括音乐、图像、影音、3D打印等电子媒介数据以及各种产品供应链。但是应用在开源贡献记录上的确很少。

### Blockchain in Open Innovation

区块链技术最初致力于为比特币提供动力，现在正日益证明它在许多其他用途上的适用性。开放创新的定义描述为由区块链技术和衍生产品支持的分布式可靠解决方案

Gitcoin 是一个基于以太坊区块链的分布式应用程序，目的是让人们在开源的贡献中获得奖励。它希望建立一个每个人远离财务烦恼来进行工作的世界。它提供了一个空间，允许开源开发人员为开源项目工作并获得报酬，相应的开源项目则可以接触到大量优秀开发人员来参与。 悬赏人将悬赏规则写入智能合约中，如完成某个开发功能奖励若干以太币或比特币。开发人员完成悬赏任务，悬赏人确定该任务被完成后即可触发智能合约，自动完成交易。

Gitcoin 有一个缺点就是需要悬赏者手动确认开发人员提交的工作是否满足悬赏要求。这个过程是可以作假的，即使开发人员提交的工作满足要求，悬赏人也可以单方面毁约。对此，ChainSoft 使用 Ethereum Smart contract 、 Github/Travis CI 和 Oracles 完善了该功能。使该过程可以变成自动代码验证，而不需要悬赏者手动参与。验证完成后如果满足要求则强制执行智能合约完成剩余的交易。但该方法需要悬赏者提前编写好若干测试用例，实施难度较大。

Josep Lluis de la Rosa, et al. 所做的工作旨在为中小型企业提供正确的 Open Innovation 知识产权保护。并且利用区块链和智能合约技术开发了一个Networked Innovation Rooms (NIR)。这将有助于降低中小企业对信息时代知识产权的担忧。

## 5. Conclusion
