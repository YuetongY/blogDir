# 知识点

- NAT穿透（UDP打洞）：[NAT穿透（UDP打洞）](https://www.cnblogs.com/GO-NO-1/p/7241556.html)

---

## TCP 和 UDP 的区别

**相同点**：
UDP协议和TCP协议都是传输层协议。

TCP（Transmission Control Protocol，传输控制协议）提供的是面向连接，可靠的字节流服务。即客户和服务器交换数据前，必须先在双方之间建立一个TCP连接，之后才能传输数据。并且提供超时重发，丢弃重复数据，检验数据，流量控制等功能，保证数据能从一端传到另一端。

UDP（User Data Protocol，用户数据报协议）是一个简单的面向数据报的运输层协议。它不提供可靠性，只是把应用程序传给IP层的数据报发送出去，但是不能保证它们能到达目的地。由于UDP在传输数据报前不用再客户和服务器之间建立一个连接，且没有超时重发等机制，所以传输速度很快。

**不同点**：

- 报头不同
- 特点不同
- 协议不同

**TCP 三次握手过程**：

第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入SYN_SENT状态，等待服务器确认；SYN：同步序列编号（Synchronize Sequence Numbers）。

第二次握手：服务器收到syn包，必须确认客户的SYN（ack=x+1），同时自己也发送一个SYN包（syn=y），即SYN+ACK包，此时服务器进入SYN_RECV状态；

第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=y+1），此包发送完毕，客户端和服务器进入ESTABLISHED（TCP连接成功）状态，完成三次握手。

![image.png](https://ww1.sinaimg.cn/large/006alGmrgy1gbrpm8gzpnj30oe0gc780.jpg)

**TCP四次挥手**：

1）客户端进程发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN=1，其序列号为seq=u（等于前面已经传送过来的数据的最后一个字节的序号加1），此时，客户端进入FIN-WAIT-1（终止等待1）状态。 TCP规定，FIN报文段即使不携带数据，也要消耗一个序号。
2）服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时，服务端就进入了CLOSE-WAIT（关闭等待）状态。TCP服务器通知高层的应用进程，客户端向服务器的方向就释放了，这时候处于半关闭状态，即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。
3）客户端收到服务器的确认请求后，此时，客户端就进入FIN-WAIT-2（终止等待2）状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最后的数据）。
4）服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器就进入了LAST-ACK（最后确认）状态，等待客户端的确认。
5）客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是seq=u+1，此时，客户端就进入了TIME-WAIT（时间等待）状态。注意此时TCP连接还没有释放，必须经过2∗∗MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB后，才进入CLOSED状态。
6）服务器只要收到了客户端发出的确认，立即进入CLOSED状态。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，服务器结束TCP连接的时间要比客户端早一些。

![image.png](https://ww1.sinaimg.cn/large/006alGmrgy1gbrprzy9e9j30rc0jc0yw.jpg)

**参考**：

- [面试题：UDP&TCP的区别](https://blog.csdn.net/sifanchao/article/details/82285018)

- [TCP的三次握手与四次挥手理解及面试题（很全面）](https://blog.csdn.net/qq_38950316/article/details/81087809)

---

## 长连接和短连接的区别

**长连接和短链接的区别**：

- 客户端和服务端响应的次数
  - 长连接：可以多次。
  - 短链接：一次。
- 传输数据的方式
  - 长连接：连接--数据传输--保持连接
  - 短连接：连接--数据传输--关闭连接

**长连接和短链接的优缺点**：

- 长连接
  - 优点
    - 省去较多的TCP建立和关闭的操作，从而节约时间。
    - 性能比较好。（因为客户端一直和服务端保持联系）
  - 缺点
    - 当客户端越来越多的时候，会将服务器压垮。
    - 连接管理难。
    - 安全性差。（因为会一直保持着连接，可能会有些无良的客户端，随意发送数据等）
- 短链接
  - 优点
    - 服务管理简单。存在的连接都是有效连接
  - 缺点
    - 请求频繁，在TCP的建立和关闭操作上浪费时间

**长连接和短连接使用情况举例**：

- 长连接
  - 微信/qq
  - 一些游戏
- 短连接
  - 普通的web网站

**参考**：[golang长连接和短连接的学习](https://www.cnblogs.com/MyUniverse/p/11621169.html)

---

## http 常见状态码，400，401，403状态码

**2XX 成功**：

- 200 OK，表示从客户端发来的请求在服务器端被正确处理
- 204 No content，表示请求成功，但响应报文不含实体的主体部分
- 206 Partial Content，进行范围请求

**3XX 重定向**：

- 301 moved permanently，永久性重定向，表示资源已被分配了新的 URL
- 302 found，临时性重定向，表示资源临时被分配了新的 URL
- 303 see other，表示资源存在着另一个 URL，应使用 GET 方法定向获取资源
- 304 not modified，表示服务器允许访问资源，但因发生请求未满足条件的情况
- 307 temporary redirect，临时重定向，和302含义相同

**4XX 客户端错误**：

- 400 bad request，请求报文存在语法错误

- 401 unauthorized，表示发送的请求需要有通过 HTTP 认证的认证信息

  请求要求进行身份验证。

- 403 forbidden，表示对请求资源的访问被服务器拒绝

- 404 not found，表示在服务器上没有找到请求的资源

**5XX 服务器错误**：

- 500 internal sever error，表示服务器端在执行请求时发生了错误
- 503 service unavailable，表明服务器暂时处于超负载或正在停机维护，无法处理请求

**参考**：[http常见的状态码，400,401,403状态码分别代表什么？](https://www.cnblogs.com/purewhite/p/10871851.html)

---

## http 协议六种请求方法，get、head、put、delete、post、options

其实我们大部分情况下只用到了GET和POST。如果想设计一个符合RESTful规范的web应用程序，则这六种方法都会用到。不过即使暂时不想涉及REST，了解这六种方法的本质仍然是很有作用的。大家将会发现，原来web也是很简洁明了的。下面依次说明这六种方法。

> 1，GET：GET可以说是最常见的了，它本质就是发送一个请求来取得服务器上的某一资源。资源通过一组HTTP头和呈现据（如HTML文本，或者图片或者视频等）返回给客户端。GET请求中，永远不会包含呈现数据。

> 2，HEAD：HEAD和GET本质是一样的，区别在于HEAD不含有呈现数据，而仅仅是HTTP头信息。有的人可能觉得这个方法没什么用，其实不是这样的。想象一个业务情景：欲判断某个资源是否存在，我们通常使用GET，但这里用HEAD则意义更加明确。
>
> HEAD方法跟GET方法相同，只不过服务器响应时不会返回消息体。一个HEAD请求的响应中，HTTP头中包含的元信息应该和一个GET请求的响应消息相同。这种方法可以用来获取请求中隐含的元信息，而不用传输实体本身。也经常用来测试超链接的有效性、可用性和最近的修改。
>
> 一个HEAD请求的响应可被缓存，也就是说，响应中的信息可能用来更新之前缓存的实体。如果当前实体跟缓存实体的阈值不同（可通过Content-Length、Content-MD5、ETag或Last-Modified的变化来表明），那么这个缓存就被视为过期了。
>
> HEAD请求常常被忽略，但是能提供很多有用的信息，特别是在有限的速度和带宽下。主要有以下特点：
>
> 1、只请求资源的首部；
>
> 2、检查超链接的有效性；
>
> 3、检查网页是否被修改；
>
> 4、多用于自动搜索机器人获取网页的标志信息，获取rss种子信息，或者传递安全认证信息等

> 3，PUT：这个方法比较少见。HTML表单也不支持这个。本质上来讲， PUT和POST极为相似，都是向服务器发送数据，但它们之间有一个重要区别，PUT通常指定了资源的存放位置，而POST则没有，POST的数据存放位置由服务器自己决定。
> 举个例子：如一个用于提交博文的URL，/addBlog。如果用PUT，则提交的URL会是像这样的”/addBlog/abc123”，其中abc123就是这个博文的地址。而如果用POST，则这个地址会在提交后由服务器告知客户端。目前大部分博客都是这样的。显然，PUT和POST用途是不一样的。具体用哪个还取决于当前的业务场景。

> 4，DELETE：删除某一个资源。基本上这个也很少见，不过还是有一些地方比如amazon的S3云服务里面就用的这个方法来删除资源。

> 5，POST：向服务器提交数据。这个方法用途广泛，几乎目前所有的提交操作都是靠这个完成。

> 6，OPTIONS：这个方法很有趣，但极少使用。它用于获取当前URL所支持的方法。若请求成功，则它会在HTTP头中包含一个名为“Allow”的头，值是所支持的方法，如“GET, POST”。

以上的六种方法，我们可以跟数据库的CRUD增删改查操作对应起来： CREATE ：PUT READ：GET UPDATE：POST DELETE：DELETE 这样一来就实现了HTTP和数据库操作（其实不光是数据库，任何数据如文件图表都是这样）的完美统一，这也是REST的精髓之一

**参考**：

- [浅谈http协议六种请求方法，get、head、put、delete、post、options区别](https://www.cnblogs.com/wei-hj/p/7859707.html)
- [HTTP head请求](https://www.cnblogs.com/longyongzhen/p/6647239.html)

---

## http keep-alive

HTTP/1.0 请求头中加上 Connection: keep-alive，可以保持长连接。HTTP/1.1 默认支持长连接

**参考**：[HTTP keep-alive详解](https://blog.csdn.net/xiaoduanayu/article/details/78386508)

---

## URI和URL

- URI：Uniform Resource Identifier，统一资源标识符

- URL：Uniform Resource Location统一资源定位符

URI是一个用于标识互联网资源名称的字符串。 该种标识允许用户对网络中（一般指万维网）的资源通过特定的协议进行交互操作。URI的最常见的形式是统一资源定位符（URL），经常指定为非正式的网址。更罕见的用法是统一资源名称（URN），其目的是通过提供一种途径。用于在特定的命名空间资源的标识，以补充网址。

通俗地说，URL和URN是URI的子集，URI属于URL更高层次的抽象，一种字符串文本标准。

三者关系如下图：

![image.png](http://ww1.sinaimg.cn/large/006alGmrgy1gaszibnbkjj308306mq38.jpg)

**参考**：[URI和URL的区别](https://www.jianshu.com/p/ba15d066f777)

---
